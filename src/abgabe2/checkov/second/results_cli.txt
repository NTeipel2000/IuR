terraform scan results:

Passed checks: 21, Failed checks: 9, Skipped checks: 0

Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32
Check: CKV_AWS_386: "Reduce potential for WhoAMI cloud image name confusion attack"
	PASSED for resource: aws_ami.amazon_linux
	File: \ec2Instance_webService.tf:1-10
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.ec2_role
	File: \iamRoleForEc2.tf:1-12
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.ec2_role
	File: \iamRoleForEc2.tf:1-12
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.ec2_role
	File: \iamRoleForEc2.tf:1-12
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: \provider.tf:12-14
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	PASSED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.ec2_role
	File: \iamRoleForEc2.tf:1-12
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_role_policy.sns_publish
	File: \iamRoleForEc2.tf:14-25
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32

		12 | resource "aws_instance" "web" {
		13 |   ami                    = data.aws_ami.amazon_linux.id
		14 |   instance_type          = "t3.micro"
		15 |   key_name               = var.key_name
		16 |   security_groups        = [aws_security_group.web_sg.name]
		17 |   iam_instance_profile   = aws_iam_instance_profile.ec2_profile.name
		18 | 
		19 |   user_data = <<-EOF
		20 |               #!/bin/bash
		21 |               yum update -y
		22 |               yum install -y httpd awscli
		23 |               systemctl start httpd
		24 |               systemctl enable httpd
		25 | 
		26 |               echo "<h1>Web Service Running</h1>" > /var/www/html/index.html
		27 |               EOF
		28 | 
		29 |   tags = {
		30 |     Name = "web-service"
		31 |   }
		32 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32

		12 | resource "aws_instance" "web" {
		13 |   ami                    = data.aws_ami.amazon_linux.id
		14 |   instance_type          = "t3.micro"
		15 |   key_name               = var.key_name
		16 |   security_groups        = [aws_security_group.web_sg.name]
		17 |   iam_instance_profile   = aws_iam_instance_profile.ec2_profile.name
		18 | 
		19 |   user_data = <<-EOF
		20 |               #!/bin/bash
		21 |               yum update -y
		22 |               yum install -y httpd awscli
		23 |               systemctl start httpd
		24 |               systemctl enable httpd
		25 | 
		26 |               echo "<h1>Web Service Running</h1>" > /var/www/html/index.html
		27 |               EOF
		28 | 
		29 |   tags = {
		30 |     Name = "web-service"
		31 |   }
		32 | }

Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32

		12 | resource "aws_instance" "web" {
		13 |   ami                    = data.aws_ami.amazon_linux.id
		14 |   instance_type          = "t3.micro"
		15 |   key_name               = var.key_name
		16 |   security_groups        = [aws_security_group.web_sg.name]
		17 |   iam_instance_profile   = aws_iam_instance_profile.ec2_profile.name
		18 | 
		19 |   user_data = <<-EOF
		20 |               #!/bin/bash
		21 |               yum update -y
		22 |               yum install -y httpd awscli
		23 |               systemctl start httpd
		24 |               systemctl enable httpd
		25 | 
		26 |               echo "<h1>Web Service Running</h1>" > /var/www/html/index.html
		27 |               EOF
		28 | 
		29 |   tags = {
		30 |     Name = "web-service"
		31 |   }
		32 | }

Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.web
	File: \ec2Instance_webService.tf:12-32

		12 | resource "aws_instance" "web" {
		13 |   ami                    = data.aws_ami.amazon_linux.id
		14 |   instance_type          = "t3.micro"
		15 |   key_name               = var.key_name
		16 |   security_groups        = [aws_security_group.web_sg.name]
		17 |   iam_instance_profile   = aws_iam_instance_profile.ec2_profile.name
		18 | 
		19 |   user_data = <<-EOF
		20 |               #!/bin/bash
		21 |               yum update -y
		22 |               yum install -y httpd awscli
		23 |               systemctl start httpd
		24 |               systemctl enable httpd
		25 | 
		26 |               echo "<h1>Web Service Running</h1>" > /var/www/html/index.html
		27 |               EOF
		28 | 
		29 |   tags = {
		30 |     Name = "web-service"
		31 |   }
		32 | }

Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25

		1  | resource "aws_security_group" "web_sg" {
		2  |   name        = "web-service-sg"
		3  |   description = "Allow HTTP and SSH"
		4  | 
		5  |   ingress {
		6  |     from_port   = 80
		7  |     to_port     = 80
		8  |     protocol    = "tcp"
		9  |     cidr_blocks = ["0.0.0.0/0"]
		10 |   }
		11 | 
		12 |   ingress {
		13 |     from_port   = 22
		14 |     to_port     = 22
		15 |     protocol    = "tcp"
		16 |     cidr_blocks = ["0.0.0.0/0"]
		17 |   }
		18 | 
		19 |   egress {
		20 |     from_port   = 0
		21 |     to_port     = 0
		22 |     protocol    = "-1"
		23 |     cidr_blocks = ["0.0.0.0/0"]
		24 |   }
		25 | }

Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25

		1  | resource "aws_security_group" "web_sg" {
		2  |   name        = "web-service-sg"
		3  |   description = "Allow HTTP and SSH"
		4  | 
		5  |   ingress {
		6  |     from_port   = 80
		7  |     to_port     = 80
		8  |     protocol    = "tcp"
		9  |     cidr_blocks = ["0.0.0.0/0"]
		10 |   }
		11 | 
		12 |   ingress {
		13 |     from_port   = 22
		14 |     to_port     = 22
		15 |     protocol    = "tcp"
		16 |     cidr_blocks = ["0.0.0.0/0"]
		17 |   }
		18 | 
		19 |   egress {
		20 |     from_port   = 0
		21 |     to_port     = 0
		22 |     protocol    = "-1"
		23 |     cidr_blocks = ["0.0.0.0/0"]
		24 |   }
		25 | }

Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25

		1  | resource "aws_security_group" "web_sg" {
		2  |   name        = "web-service-sg"
		3  |   description = "Allow HTTP and SSH"
		4  | 
		5  |   ingress {
		6  |     from_port   = 80
		7  |     to_port     = 80
		8  |     protocol    = "tcp"
		9  |     cidr_blocks = ["0.0.0.0/0"]
		10 |   }
		11 | 
		12 |   ingress {
		13 |     from_port   = 22
		14 |     to_port     = 22
		15 |     protocol    = "tcp"
		16 |     cidr_blocks = ["0.0.0.0/0"]
		17 |   }
		18 | 
		19 |   egress {
		20 |     from_port   = 0
		21 |     to_port     = 0
		22 |     protocol    = "-1"
		23 |     cidr_blocks = ["0.0.0.0/0"]
		24 |   }
		25 | }

Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.web_sg
	File: \securityGroup.tf:1-25

		1  | resource "aws_security_group" "web_sg" {
		2  |   name        = "web-service-sg"
		3  |   description = "Allow HTTP and SSH"
		4  | 
		5  |   ingress {
		6  |     from_port   = 80
		7  |     to_port     = 80
		8  |     protocol    = "tcp"
		9  |     cidr_blocks = ["0.0.0.0/0"]
		10 |   }
		11 | 
		12 |   ingress {
		13 |     from_port   = 22
		14 |     to_port     = 22
		15 |     protocol    = "tcp"
		16 |     cidr_blocks = ["0.0.0.0/0"]
		17 |   }
		18 | 
		19 |   egress {
		20 |     from_port   = 0
		21 |     to_port     = 0
		22 |     protocol    = "-1"
		23 |     cidr_blocks = ["0.0.0.0/0"]
		24 |   }
		25 | }

Check: CKV_AWS_26: "Ensure all data stored in the SNS topic is encrypted"
	FAILED for resource: aws_sns_topic.notifications
	File: \snsTopic_emailSubscription.tf:1-3

		1 | resource "aws_sns_topic" "notifications" {
		2 |   name = "web-service-notifications"
		3 | }

